<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Slides</title>
    <script src="http://code.jquery.com/jquery-latest.min.js"></script>
</head>
<body>
<div class="arts">
    <div class="pics" style="width:200px; height: 150px; background-color: red"></div>
    <div class="pics" style="width:200px; height: 150px; background-color: blue"></div>
    <div class="pics" style="width:200px; height: 150px; background-color: yellow"></div>
    <div class="pics" style="width:200px; height: 150px; background-color: green"></div>
    <div class="pics" style="width:200px; height: 150px; background-color: pink"></div>
</div>
</body>
<script>
	$.fn.slides = function (options) {
		var $arts = this
		$arts.each(function () {
			var $art = $(this)
			var height = options.height
			var width = options.width
			var $pics = $arts.children()
				.wrapAll('<div class="list"></div>')
				.css({float: 'left'})

        /* list宽度为图片并排宽度，通过改变其left值改变显示的图片 */
			$list = $arts.children().wrapAll('<div class="viewpoint"></div>')
			$list.css({
				width: $pics.length * width,
				position: 'relative',
				left: 0
			})

        /* 为list提供容器 */
			var $viewpoint = $list.parent()
			$viewpoint.css({
				width: width,
				height: height,
				overflow: 'hidden'
			})

        /* 通过当前图片的index来计算animate的位置*/
			var current = 0
			var hover = false
			var $next = $('<button>next</button>').appendTo($arts)
			var $prev = $('<button>prev</button>').appendTo($arts)
			var go = function (index) {
				console.log(index)
				if (index < 0) {
					index = $pics.length - 1
				}
				if (index > $pics.length - 1) {
					index = 0
				}
				if (timer) {
					window.clearInterval(timer)
				}
				var left = index * (-200)
				$list.stop(true, true).animate({
					left: left
				}, function () {
					current = index
					if (!hover) {
						autoplay()
					}
				})
			}
			$next.on('click', function () {
				go(current + 1)
			})
			$prev.on('click', function () {
				go(current - 1)
			})

        /*通过计时器和mouseenter事件，增加自动播放和自动悬停功能*/
			var timer
			var autoplay = function () {
				timer = setInterval(function () {
					go(current + 1)
				}, 3000)
			}
			if (options.auto) {
				autoplay()
			}
			$pics.on('mouseenter', function () {
				window.clearInterval(timer)
				hover = true
			}).on('mouseleave', function () {
				autoplay()
				hover = false
			})
		})

	}

	$('.arts').slides({
		height: 150,
		width: 200,
		auto: true
	})
</script>
</html>